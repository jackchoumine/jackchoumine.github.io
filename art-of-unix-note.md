# 《unix 的艺术》读书笔记

## 机制和策略分离

机制：提供什么功能，策略：如何使用这些功能。

大部分程序问题，可分为两部分：提供什么样的功能和如何使用这些功能。

机制和策略分离，有利于未来扩展。因为机制和策略按照不同的变化频率不同，策略的变化快于机制。

GUI 工具包的时尚感来取匆匆，而光栅操作和组合永生。该原则试图将程序分成**变得快**和**变得慢**的两部分，这点和设计模式中分离**可变**和**不变**是异曲同工。

> 理解和应用这个原则的关键是区分程序中易变和不易变的部分，不易变的部分往往属于机制，基础功能，而易变部分属于策略，属于业务逻辑，业务逻辑可以由不变的机制组合而来。

说实话，这样的定义很迷糊，应用好它完全靠程序员的经验和对系统业务的理解。

如果不理解这个原则，可再结合界面开发理解。

界面开发中通常可能分为 web、ios 和安卓，这三端的功能往往是一样的，背后通常都依赖同一套后端服务，后端服务类似机制，而不同平台的客户端类似策略。

哪天又出来了一个新平台，可能又需要新的客户端，但是还是依赖同一套后端服务。这就是机制不易变，而策略易变。

再举一个例子，有一个 js 库，核心功能不变，属于机制，但是可提供 react 和 vue 的 hook 版本。hook 的用法依赖特定的框架，哪天这两个框架被新兴的框架取代，这个库的底层功能还是不变，只是不再使用的是 hook 部分。

> 结合这个原则再聊聊前端开发的特点。

前端开发中，需求变化往往比后端开发快，今天客户可能希望换一个按钮的颜色，明天可能交互方式又要改了，但是后端 api（数据）和功能不变。

所以业界提出数据层和 UI 层，试图把易变的 UI 和不易变的数据层分离，具体来说通过 pinia、zustand、redux 或者 hook 分离数据，而 UI 保持独立。

前端修改页面和改动交互，工作杂，技术难度不高，但是业务价值高，用户提出来了，你不得不做，因此有的人甚至觉得前端就整一个 UI 界面，没啥难度，似乎是有一定的道理的。

经过上述讨论，可得出一个结论：软件中靠近用户的部分（UI）往往易变多变，远离用户的部分（数据服务）往往不易变。在易变的 UI 开发中，也要尽可能区分不易变的机制或者数据和易变的 UI 展示或者交互，才能让客户端软件（ios、安卓和 web）更容易扩展和维护。
