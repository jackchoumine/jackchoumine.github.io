# vue2 组件测试

## 前端测试

软件测试：检查软件是否按照预期工作的过程。

测试分类：

从是否需要手动测试来分：

- 手动测试：需要人工操作，比如点击按钮，输入文字等。
- 自动测试：写代码测试其他代码，不需要人亲自手动测试每一个功能。

前端测试，从测试的范围来分：

1. 端到端测试

测试整个应用，从用户角度出发，**浏览器自动**测试整个应用是否按照预期工作。是自动执行的手动测试，加快手动测试的速度。

- 优点：测试全面，测试结果可靠。
- 缺点：① 测试速度慢 ② 调试困难 ③ 可能成为 flakey 测试 ④ 编写测试代码的成本高。

> flakey 测试：即使程序没有问题，测试也会失败。

2. 单元测试

对应用的小部分进行的测试。比如测试一个函数，一个组件等。

- 优点：① 测试速度快 ② 调试方便 ③ 编写测试代码的成本低 ④ 提供文档功能，可通过测试用例了解代码的行为 ⑤ 稳定，有助于重构。
- 缺点：测试范围小，测试结果不可靠。

> 重构：不改变代码的功能，但是改变代码的结构，目的是为了提高代码质量。

3. 快照测试

快照测试会给运行中的应用程序拍一张图片，并将其与以前保存的图片进行比较。如果图像不同，则测试失败。这种测试方法对确保应用程序代码变更后是否仍然可以正确渲染很有帮助。

各种测试在前端测试中的占比

![](https://jsd.cdn.zzko.cn/gh/jackchoumine/jack-picture@master/front-end-test.png)

> 为何没有集成测试？

前端的集成测试，难以定义、编写和调试，通常认为端到端测试就是集成测试。

> 什么时候不需要自动化测试？

自动化测试的目的是为了节省时间和精力，**长期开发**的**规模较大**的项目自动化测试才会带来巨大的收益。如果项目只是一个小项目，或者是一个短期项目，那么自动化测试可能会带来负担，即编写测试代码会比直接编写应用代码更花时间。

实际上，在我的工作中，前端进行自动化测试的团队都很少，大部分都是手动测试。

> 不必追求 100% 的测试覆盖率

除非一个 bug 导致了严重的后果，比如损失几百万元，否则不必追求 100% 的测试覆盖率。因为测试代码也是需要维护的，测试代码的维护成本也是需要考虑的。

### 组件测试

组件有很多属性，决定测试哪些属性很重要，能帮助编写高效的测试代码。

> 如何决定测试哪些属性？

**组件的输入和输出**（有人叫组件契约或者组件接口）可帮助决定测试哪些属性。

从开发人员使用组件但又不了解组件具体实现的角度来编写测试，好的组件单元测试应该始终可触发一个输入，并断言一个输出。

常见的组件输入：

1. 用户操作，比如点击按钮，输入文字等；
2. props；
3. 组件事件；
4. vuex store 中的数据。

常见的输出：

1. 触发的事件；
2. 外部调用函数；
3. 渲染结果。
