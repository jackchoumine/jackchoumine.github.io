import{_ as s,o as n,c as a,a as e}from"./app.cfece96f.js";const C=JSON.parse('{"title":"你知道 npmrc 文档吗？ ---- npmrc 关键作用介绍","description":"","frontmatter":{},"headers":[{"level":2,"title":"如何修改配置呢？","slug":"如何修改配置呢","link":"#如何修改配置呢","children":[]},{"level":2,"title":"日常开放常常需要置哪些信息呢？","slug":"日常开放常常需要置哪些信息呢","link":"#日常开放常常需要置哪些信息呢","children":[{"level":3,"title":"registry 信息","slug":"registry-信息","link":"#registry-信息","children":[]},{"level":3,"title":"配置限定包","slug":"配置限定包","link":"#配置限定包","children":[]},{"level":3,"title":"认证信息","slug":"认证信息","link":"#认证信息","children":[]},{"level":3,"title":"代理配置","slug":"代理配置","link":"#代理配置","children":[]},{"level":3,"title":"缓存配置","slug":"缓存配置","link":"#缓存配置","children":[]},{"level":3,"title":"安装行为","slug":"安装行为","link":"#安装行为","children":[]}]},{"level":2,"title":"参考","slug":"参考","link":"#参考","children":[]}],"relativePath":"node/what-is-npmrc.md"}'),l={name:"node/what-is-npmrc.md"},p=e(`<h1 id="你知道-npmrc-文档吗-npmrc-关键作用介绍" tabindex="-1">你知道 npmrc 文档吗？ ---- npmrc 关键作用介绍 <a class="header-anchor" href="#你知道-npmrc-文档吗-npmrc-关键作用介绍" aria-hidden="true">#</a></h1><p><code>.npmrc</code> 是 npm 的配置文件。rc 是 registry config 缩写。</p><p>npm 在执行命令时，会读取里面的配置，然后执行特定的行为，通过它可改变 npm 的默认行为，比如下载精确版本的 npm 包，从某个 npm 源的下载依赖等。</p><p>有<em>4</em>种 <code>.npmrc</code> 文件，npm 会依次读取这些文件，后面的文件会覆盖前面的文件的配置。</p><ol><li>项目级别的 <code>.npmrc</code> 文件，在 <code>package.json</code> 文件所在的目录。</li><li>用户级别的 <code>.npmrc</code> 文件，在用户的根目录。通过 <code>npm config get userconfig</code> 查看。</li><li>全局级别的 <code>.npmrc</code> 文件, 在 npm 的安装目录下。通过 <code>npm config get globalconfig</code> 查看。</li><li>内置的 <code>.npmrc</code> 文件，npm 自带的配置文件，无法修改，基本不会用到。</li></ol><blockquote><p>主要关注项目级别的 <code>.npmrc</code> 文件和用户级别的 <code>.npmrc</code> 文件。</p></blockquote><p>一个典型的配置：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># save-exact 的优先级更加高</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># save-exact=true</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 相似版本</span></span>
<span class="line"><span style="color:#A6ACCD;">save-prefix</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">~</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 从淘宝镜像下载</span></span>
<span class="line"><span style="color:#A6ACCD;">registry</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">https://registry.npmmirror.com</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 指定 node-sass 镜像 提高下载速度</span></span>
<span class="line"><span style="color:#A6ACCD;">sass_binary_site</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">https://npmmirror.com/mirrors/node-sass</span></span>
<span class="line"><span style="color:#A6ACCD;">electron_mirror</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">https://npmmirror.com/mirrors/electron/</span></span>
<span class="line"><span style="color:#A6ACCD;">electron_builder_binaries_mirror</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">https://npmmirror.com/mirrors/electron-builder-binaries/</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 详细日志 常用于调试</span></span>
<span class="line"><span style="color:#A6ACCD;">loglevel</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">verbose</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>从<strong>命令行传递的参数</strong>优先级最高，然后是项目级别的配置，然后是用户级别的配置，最后是全局级别的配置。</p></blockquote><blockquote><p>编码务必使用 UTF-8 编码，否则可能不会读取配置。</p></blockquote><blockquote><p><code>#</code> 或者 <code>;</code> 表示注释。</p></blockquote><h2 id="如何修改配置呢" tabindex="-1">如何修改配置呢？ <a class="header-anchor" href="#如何修改配置呢" aria-hidden="true">#</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> [key] </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-g</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># -g 全局配置</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">save-prefix</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">^</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">registry</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://registry.npmmirror.com/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">get</span><span style="color:#A6ACCD;"> [key] </span><span style="color:#676E95;font-style:italic;"># 查看配置</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">get</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cache</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 查看缓存目录</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">list</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 查看本地配置</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">list</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-g</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 全局配置</span></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">config</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">list</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 用户配置</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="日常开放常常需要置哪些信息呢" tabindex="-1">日常开放常常需要置哪些信息呢？ <a class="header-anchor" href="#日常开放常常需要置哪些信息呢" aria-hidden="true">#</a></h2><h3 id="registry-信息" tabindex="-1">registry 信息 <a class="header-anchor" href="#registry-信息" aria-hidden="true">#</a></h3><p>npm 的源，可以是官方源，也可以是第三方源，比如淘宝源，或者公司的私有源。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 官方源</span></span>
<span class="line"><span style="color:#A6ACCD;">registry</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">https://registry.npmjs.org/</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 淘宝源</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># registry=https://registry.npmmirror.com/</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="配置限定包" tabindex="-1">配置限定包 <a class="header-anchor" href="#配置限定包" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">@myscope:registry</span><span style="color:#A6ACCD;">=https://mycustomregistry.example.org</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="认证信息" tabindex="-1">认证信息 <a class="header-anchor" href="#认证信息" aria-hidden="true">#</a></h3><p>当使用私有的 npm 源时，可能需要认证信息。</p><blockquote><p>注意认证信息的应用范围，源和认证信息不对应，可能导致404。</p></blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># bad config</span></span>
<span class="line"><span style="color:#FFCB6B;">@myorg:registry</span><span style="color:#A6ACCD;">=https://somewhere-else.com/myorg</span></span>
<span class="line"><span style="color:#FFCB6B;">@another:registry</span><span style="color:#A6ACCD;">=https://somewhere-else.com/another</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># _authToken 将应用到 @myorg 和 @another 两个源上</span></span>
<span class="line"><span style="color:#FFCB6B;">//somewhere-else.com/:_authToken</span><span style="color:#A6ACCD;">=MYTOKEN</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 只应用到 @myorg 上</span></span>
<span class="line"><span style="color:#FFCB6B;">//somewhere-else.com/myorg/:_authToken</span><span style="color:#A6ACCD;">=MYTOKEN1</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 只应用到 @another 上</span></span>
<span class="line"><span style="color:#FFCB6B;">//somewhere-else.com/another/:_authToken</span><span style="color:#A6ACCD;">=MYTOKEN2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 从 gitlab 的私有仓库下载依赖</span></span>
<span class="line"><span style="color:#FFCB6B;">@jackzhoumine:registry</span><span style="color:#A6ACCD;">=https://gitlab.com/api/v4/projects/54539895/packages/npm/</span></span>
<span class="line"><span style="color:#FFCB6B;">//gitlab.com/api/v4/projects/54539895/packages/npm/:_authToken</span><span style="color:#A6ACCD;">=glpat-3759QXSo9Pz9FxGe12324</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>可通过这些信息认证：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">_auth</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># (base64 authentication string)</span></span>
<span class="line"><span style="color:#FFCB6B;">_authToken</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#(authentication token)</span></span>
<span class="line"><span style="color:#FFCB6B;">username</span></span>
<span class="line"><span style="color:#FFCB6B;">_password</span></span>
<span class="line"><span style="color:#FFCB6B;">email</span></span>
<span class="line"><span style="color:#FFCB6B;">certfile</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># (path to certificate file)</span></span>
<span class="line"><span style="color:#FFCB6B;">keyfile</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># (path to key file)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>通过 <code>npm login</code> 登录，会自动添加认证信息。</p></blockquote><blockquote><p>认证信息是敏感信息，不要提交到代码仓库。</p></blockquote><blockquote><p>不能配置多个源对多个源的认证信息。</p></blockquote><h3 id="代理配置" tabindex="-1">代理配置 <a class="header-anchor" href="#代理配置" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">proxy</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">http://username:password@proxy-server-address:port</span></span>
<span class="line"><span style="color:#A6ACCD;">https-proxy</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">https://username:password@proxy-server-address:port</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="缓存配置" tabindex="-1">缓存配置 <a class="header-anchor" href="#缓存配置" aria-hidden="true">#</a></h3><p>配置 node 依赖的缓存。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">cache</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">your/path/to/cache</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="安装行为" tabindex="-1">安装行为 <a class="header-anchor" href="#安装行为" aria-hidden="true">#</a></h3><p>比如默认安装的时候，是否保存精确版本，依赖信息是否保存到 <code>package.json</code> 文件等。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 相似版本</span></span>
<span class="line"><span style="color:#A6ACCD;">save-prefix</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">~</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-hidden="true">#</a></h2><ul><li><a href="https://docs.npmjs.com/cli/v10/configuring-npm/npmrc" target="_blank" rel="noreferrer">npm-npmrc</a></li><li><a href="https://medium.com/@pmmanav/what-is-a-npmrc-file-e7bd40bff3f0" target="_blank" rel="noreferrer">What is a .npmrc file?</a></li><li><a href="https://zhuanlan.zhihu.com/p/651477901" target="_blank" rel="noreferrer">深入了解npmrc：使用与配置指南</a></li></ul>`,38),o=[p];function r(c,t,i,y,d,m){return n(),a("div",null,o)}const h=s(l,[["render",r]]);export{C as __pageData,h as default};
